<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Publicações - Profa. Rosiery Maia</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <!-- FontAwesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #9b9b9b;
            --secondary-color: #f8edeb;
            --accent-color: #ffa8be;
            --text-color: #36617c;
            --dark-text: #3e6cad;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--secondary-color);
            color: var(--text-color);
        }

        .navbar {
            background-color: var(--primary-color);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .navbar-brand, .nav-link {
          color: var(--secondary-color) !important;
            font-weight: 600;
        }

        .nav-link.active {
            background-color: var(--accent-color);
            color: var(--text-color) !important;
            border-radius: 10px;
            padding: 8px 15px;
        }

        .nav-link:hover {
            color: var(--text-color) !important;
        }

        .page-header {
            background-color: var(--primary-color);
            padding: 0rem 0;
            border-radius: 0 0 50px 50px;
            margin-bottom: 3rem;
        }

        .section-title {
            color: var(--dark-text);
            position: relative;
            padding-bottom: 15px;
            margin-bottom: 30px;
        }

        .section-title::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 70px;
            height: 3px;
            background-color: var(--accent-color);
        }

        .section {
            padding: 4rem 0;
        }

        .btn-custom {
            background-color: var(--accent-color);
            color: var(--dark-text);
            border: none;
            font-weight: 600;
            padding: 10px 20px;
            border-radius: 30px;
            transition: all 0.3s ease;
        }

        .btn-custom:hover {
            background-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0,0,0,0.1);
        }

        footer {
            background-color: var(--primary-color);
            padding-top: 0.5rem;
            margin-top: 3rem;
        }

        .social-icons a {
            color: var(--dark-text);
            font-size: 1.5rem;
            margin: 0 10px;
            transition: color 0.3s ease;
        }

        .social-icons a:hover {
            color: var(--text-color);
        }

        .publication-item {
            background-color: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            transition: transform 0.3s ease;
        }

        .publication-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .publication-type {
            background-color: var(--accent-color);
            color: var(--dark-text);
            padding: 5px 15px;
            border-radius: 30px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-block;
            margin-bottom: 10px;
            text-transform: capitalize; /* Para garantir que a primeira letra seja maiúscula */
        }

        .publication-year {
            color: var(--text-color);
            font-size: 0.9rem;
            font-weight: 600;
        }

        .publication-title {
            color: var(--dark-text);
            margin-bottom: 10px;
        }

        .publication-authors {
            font-style: italic;
            margin-bottom: 10px;
        }

        .publication-journal {
            margin-bottom: 15px;
        }

        .publication-stats {
            display: flex;
            margin-top: 15px;
            border-top: 1px solid #eee;
            padding-top: 15px;
        }

        .pub-stat {
            margin-right: 20px;
            display: flex;
            align-items: center;
        }

        .pub-stat i {
            color: var(--accent-color);
            margin-right: 5px;
        }

        .filter-buttons {
            margin-bottom: 2rem;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg sticky-top">
        <div class="container">
            <a class="navbar-brand fs-3" href={% url 'index' %}>Profa. Rosiery Maia</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
           <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href={% url 'index' %}>Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href={% url 'pesquisa' %}>Áreas de Pesquisa</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href={% url 'projetos' %}>Projetos</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href={% url 'publicacoes' %}>Publicações</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href={% url 'orientacoes' %}>Orientações</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href={% url 'contato' %}>Contato</a>
                    </li>
                    <li class="nav-item ms-3"> <a class="nav-link" href={% url 'dashboard' %}>Admin</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Page Header -->
    <header class="page-header">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 mx-auto text-center">
                    <h1 class="display-4 fw-bold">Publicações</h1>
                    <p class="lead">Conheça meus artigos científicos, livros e outras produções acadêmicas.</p>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <section class="section">
        <div class="container">
            <div class="filter-buttons text-center">
                <button class="btn btn-custom active me-2 mb-2" data-filter="all">Todos</button>
                <button class="btn btn-outline-dark me-2 mb-2" data-filter="artigo">Artigos</button>
                <button class="btn btn-outline-dark me-2 mb-2" data-filter="livro">Livros</button>
                <button class="btn btn-outline-dark me-2 mb-2" data-filter="capitulo">Capítulos</button>
                <button class="btn btn-outline-dark mb-2" data-filter="conferencia">Conferências</button>
            </div>

            <div class="publication-list" id="dynamic-publications">
                <!-- Publicações serão carregadas dinamicamente aqui -->
                <p class="text-center w-100" id="loading-message">Carregando publicações...</p>
            </div>

            <div class="text-center mt-5">
                <!-- Botão "Ver Mais" pode ser usado para paginação ou apenas removido se todos carregarem de uma vez -->
                <a href="#" class="btn btn-custom" style="display: none;">Ver Mais Publicações</a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
                     <h5>Profa. Dra. Rosiery Maia</h5>
                    <p>Universidade do Estado do Rio Grande do Norte-UERN<br>
                    Departamento de Ciência da Computação<br>
                    Campus Avançado de Natal</p>
                </div>
                <div class="col-md-6 text-center text-md-end">
                    <div class="social-icons mb-3">
                        <a href="#"><i class="fab fa-linkedin"></i></a>
                        <a href="#"><i class="fab fa-researchgate"></i></a>
                        <a href="#"><i class="fab fa-google"></i></a>
                        <a href="#"><i class="fab fa-github"></i></a>
                    </div>
                    <p>&copy; 2025 Profa. Rosiery Maia. Todos os direitos reservados.</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const publicationsApiUrl = '/api/publicacoes/'; // URL da sua API de Publicações
            let allPublications = []; // Para armazenar todas as publicações

            const dynamicPublicationsContainer = document.getElementById('dynamic-publications');
            const loadingMessage = document.getElementById('loading-message');
            const filterButtons = document.querySelectorAll('.filter-buttons button');

            // Função para renderizar as publicações no HTML
            function renderPublications(publicationsToDisplay) {
                dynamicPublicationsContainer.innerHTML = ''; // Limpa o conteúdo atual

                if (publicationsToDisplay.length === 0) {
                    dynamicPublicationsContainer.innerHTML = '<p class="text-center w-100">Nenhuma publicação encontrada para esta categoria.</p>';
                    return;
                }

                publicationsToDisplay.forEach(pub => {
                    const downloadPdfButton = pub.arquivo ?
                        `<a href="${pub.arquivo}" class="btn btn-custom btn-sm" download>Download PDF</a>` : '';

                    const externalLinkButton = pub.link ?
                        `<a href="${pub.link}" class="btn btn-outline-dark btn-sm" target="_blank">Acessar Publicação</a>` : '';

                    const pubHtml = `
                        <div class="publication-item" data-category="${pub.categoria.toLowerCase()}">
                            <span class="publication-type">${pub.categoria}</span>
                            <span class="publication-year float-end">${pub.ano}</span>
                            <h4 class="publication-title">${pub.titulo}</h4>
                            <p class="publication-authors">${pub.autores}</p>
                            <p class="publication-journal">${pub.publicado_no}</p>
                            <p>${pub.descricao || ''}</p>
                            <!-- Estatísticas (ex: citações, visualizações, downloads) não estão na API atual,
                                 então são deixadas como estáticas ou removidas. Você pode adicionar mock-data ou remover. -->
                            <div class="publication-stats">
                                <div class="pub-stat"><i class="fas fa-quote-right"></i> 0 citações</div>
                                <div class="pub-stat"><i class="fas fa-eye"></i> 0 visualizações</div>
                                <div class="pub-stat"><i class="fas fa-download"></i> 0 downloads</div>
                            </div>
                            <div class="mt-3">
                                ${downloadPdfButton}
                                ${externalLinkButton}
                            </div>
                        </div>
                    `;
                    dynamicPublicationsContainer.innerHTML += pubHtml;
                });
            }

            // Função para filtrar e exibir publicações
            function filterPublications(filter) {
                const filtered = filter === 'all' ? allPublications :
                                 allPublications.filter(pub => pub.categoria.toLowerCase() === filter);
                renderPublications(filtered);
            }

            // Adiciona listeners aos botões de filtro
            filterButtons.forEach(button => {
                button.addEventListener('click', function() {
                    filterButtons.forEach(btn => {
                        btn.classList.remove('active', 'btn-custom');
                        btn.classList.add('btn-outline-dark');
                    });
                    this.classList.add('active', 'btn-custom');
                    this.classList.remove('btn-outline-dark');

                    const filterValue = this.getAttribute('data-filter');
                    filterPublications(filterValue);
                });
            });

            // Faz a requisição à API para carregar as publicações
            fetch(publicationsApiUrl)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Erro ao carregar publicações: ' + response.statusText);
                    }
                    return response.json();
                })
                .then(data => {
                    allPublications = data; // Armazena todas as publicações
                    loadingMessage.style.display = 'none'; // Esconde a mensagem de carregamento
                    filterPublications('all'); // Exibe todas as publicações inicialmente
                })
                .catch(error => {
                    console.error('Erro ao buscar publicações:', error);
                    loadingMessage.textContent = 'Não foi possível carregar as publicações. Por favor, tente novamente mais tarde.';
                    loadingMessage.classList.add('text-danger');
                });
        });
    </script>
</body>
</html>
